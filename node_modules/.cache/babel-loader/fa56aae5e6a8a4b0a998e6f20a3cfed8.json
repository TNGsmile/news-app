{"remainingRequest":"/Users/smile/Documents/vue-5-27/news-app/node_modules/babel-loader/lib/index.js!/Users/smile/Documents/vue-5-27/news-app/src/services/userService.js","dependencies":[{"path":"/Users/smile/Documents/vue-5-27/news-app/src/services/userService.js","mtime":1591005040787},{"path":"/Users/smile/Documents/vue-5-27/news-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/smile/Documents/vue-5-27/news-app/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9zbWlsZS9Eb2N1bWVudHMvdnVlLTUtMjcvbmV3cy1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwoKZnVuY3Rpb24gZGVsYXkoZHVyYXRpb24pIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICByZXNvbHZlKCk7CiAgICB9LCBkdXJhdGlvbik7CiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBsb2dpbihfeCkgewogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSAvLyDkvb/nlKjkv53lrZjnmoTku6TniYzku47mnI3liqHlmajmjaLlj5bnmbvlvZXkv6Hmga8KCmZ1bmN0aW9uIF9sb2dpbigpIHsKICBfbG9naW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUobG9naW5JbmZvKSB7CiAgICB2YXIgcmVzcCwgdG9rZW47CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gZGVsYXkoMjAwMCk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoIi9hcGkvdXNlci9sb2dpbiIsIGxvZ2luSW5mbyk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXNwID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgdG9rZW4gPSByZXNwLmhlYWRlcnMuYXV0aG9yaXphdGlvbjsgLy8g5ou/5Yiw5pyN5Yqh5Zmo55qE5Luk54mMCgogICAgICAgICAgICBpZiAodG9rZW4pIHsKICAgICAgICAgICAgICAvLyDmiorku6TniYzkv53lrZjkuIvmnaUKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCB0b2tlbik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlc3AuZGF0YSk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gX2xvZ2luLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiB3aG9BbUkoKSB7CiAgcmV0dXJuIF93aG9BbUkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSAvLyDms6jplIAKCmZ1bmN0aW9uIF93aG9BbUkoKSB7CiAgX3dob0FtSSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICB2YXIgdG9rZW4sIHJlc3A7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBkZWxheSgyMDAwKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIik7CgogICAgICAgICAgICBpZiAodG9rZW4pIHsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLmdldCgiL2FwaS91c2VyL3dob2FtaSIsIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiAiYmVhcmVyICIuY29uY2F0KHRva2VuKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICByZXNwID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZXNwLmRhdGEuZGF0YSk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwogIHJldHVybiBfd2hvQW1JLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBsb2dpbk91dCgpIHsKICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgidG9rZW4iKTsKfSAvLyDms6jlhowKCmV4cG9ydCBmdW5jdGlvbiByZWcoX3gyKSB7CiAgcmV0dXJuIF9yZWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3JlZygpIHsKICBfcmVnID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh1c2VySW5mbykgewogICAgdmFyIHJlc3A7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KCIvYXBpL3VzZXIvcmVnIiwgdXNlckluZm8pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUzKTsKICB9KSk7CiAgcmV0dXJuIF9yZWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQ=="},{"version":3,"sources":["/Users/smile/Documents/vue-5-27/news-app/src/services/userService.js"],"names":["axios","delay","duration","Promise","resolve","setTimeout","login","loginInfo","post","resp","token","headers","authorization","localStorage","setItem","data","whoAmI","getItem","get","loginOut","removeItem","reg","userInfo"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AACA,SAASC,KAAT,CAAgBC,QAAhB,EAA0B;AACxB,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9BC,IAAAA,UAAU,CAAC,YAAM;AACfD,MAAAA,OAAO;AACR,KAFS,EAEPF,QAFO,CAAV;AAGD,GAJM,CAAP;AAKD;;AACD,gBAAsBI,KAAtB;AAAA;AAAA,C,CAYA;;;mEAZO,iBAAsBC,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCN,KAAK,CAAC,IAAD,CADN;;AAAA;AAAA;AAAA,mBAGYD,KAAK,CAACQ,IAAN,CAAW,iBAAX,EAA8BD,SAA9B,CAHZ;;AAAA;AAGDE,YAAAA,IAHC;AAIDC,YAAAA,KAJC,GAIOD,IAAI,CAACE,OAAL,CAAaC,aAJpB,EAImC;;AACxC,gBAAIF,KAAJ,EAAW;AACT;AACAG,cAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BJ,KAA9B;AACD;;AARI,6CASED,IAAI,CAACM,IATP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAaP,gBAAsBC,MAAtB;AAAA;AAAA,C,CAgBA;;;oEAhBO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGCf,KAAK,CAAC,IAAD,CAHN;;AAAA;AAIDS,YAAAA,KAJC,GAIOG,YAAY,CAACI,OAAb,CAAqB,OAArB,CAJP;;AAAA,gBAKAP,KALA;AAAA;AAAA;AAAA;;AAAA,8CAMI,IANJ;;AAAA;AAAA;AAAA,mBAQYV,KAAK,CAACkB,GAAN,CAAU,kBAAV,EAA8B;AAC7CP,cAAAA,OAAO,EAAE;AACPC,gBAAAA,aAAa,mBAAYF,KAAZ;AADN;AADoC,aAA9B,CARZ;;AAAA;AAQDD,YAAAA,IARC;AAAA,8CAaEA,IAAI,CAACM,IAAL,CAAUA,IAbZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAiBP,OAAO,SAASI,QAAT,GAAqB;AAC1BN,EAAAA,YAAY,CAACO,UAAb,CAAwB,OAAxB;AACD,C,CAED;;AACA,gBAAsBC,GAAtB;AAAA;AAAA;;;iEAAO,kBAAoBC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEYtB,KAAK,CAACQ,IAAN,CAAW,eAAX,EAA4Bc,QAA5B,CAFZ;;AAAA;AAEDb,YAAAA,IAFC;AAAA,8CAGEA,IAAI,CAACM,IAHP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import axios from \"axios\";\nfunction delay (duration) {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, duration)\n  })\n}\nexport async function login (loginInfo) {\n  await delay(2000);\n  // post http://study.yuanjin.tech/api/user/login\n  var resp = await axios.post(\"/api/user/login\", loginInfo);\n  var token = resp.headers.authorization; // 拿到服务器的令牌\n  if (token) {\n    // 把令牌保存下来\n    localStorage.setItem(\"token\", token);\n  }\n  return resp.data;\n}\n\n// 使用保存的令牌从服务器换取登录信息\nexport async function whoAmI () {\n  // get http://study.yuanjin.tech/api/user/whoami\n  // authorization: bearer tokenxxxxx\n  await delay(2000);\n  var token = localStorage.getItem(\"token\");\n  if (!token) {\n    return null;\n  }\n  var resp = await axios.get(\"/api/user/whoami\", {\n    headers: {\n      authorization: `bearer ${token}`,\n    },\n  });\n  return resp.data.data;\n}\n\n// 注销\nexport function loginOut () {\n  localStorage.removeItem(\"token\");\n}\n\n// 注册\nexport async function reg (userInfo) {\n  // post http://study.yuanjin.tech/api/user/reg\n  var resp = await axios.post(\"/api/user/reg\", userInfo);\n  return resp.data;\n}\n"]}]}