{"remainingRequest":"/Users/smile/Documents/源码/16. 登录和注册接口/news-app/node_modules/babel-loader/lib/index.js!/Users/smile/Documents/源码/16. 登录和注册接口/news-app/src/services/userService.js","dependencies":[{"path":"/Users/smile/Documents/源码/16. 登录和注册接口/news-app/src/services/userService.js","mtime":1589789834000},{"path":"/Users/smile/Documents/源码/16. 登录和注册接口/news-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/smile/Documents/源码/16. 登录和注册接口/news-app/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL3NtaWxlL0RvY3VtZW50cy9cdTZFOTBcdTc4MDEvMTYuIFx1NzY3Qlx1NUY1NVx1NTQ4Q1x1NkNFOFx1NTE4Q1x1NjNBNVx1NTNFMy9uZXdzLWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmV4cG9ydCBmdW5jdGlvbiBsb2dpbihfeCkgewogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSAvLyDkvb/nlKjkv53lrZjnmoTku6TniYzku47mnI3liqHlmajmjaLlj5bnmbvlvZXkv6Hmga8KCmZ1bmN0aW9uIF9sb2dpbigpIHsKICBfbG9naW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUobG9naW5JbmZvKSB7CiAgICB2YXIgcmVzcCwgdG9rZW47CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gYXhpb3MucG9zdCgiL2FwaS91c2VyL2xvZ2luIiwgbG9naW5JbmZvKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICB0b2tlbiA9IHJlc3AuaGVhZGVycy5hdXRob3JpemF0aW9uOyAvLyDmi7/liLDmnI3liqHlmajnmoTku6TniYwKCiAgICAgICAgICAgIGlmICh0b2tlbikgewogICAgICAgICAgICAgIC8vIOaKiuS7pOeJjOS/neWtmOS4i+adpQogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHRva2VuKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHdob0FtSSgpIHsKICByZXR1cm4gX3dob0FtSS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9IC8vIOazqOmUgAoKZnVuY3Rpb24gX3dob0FtSSgpIHsKICBfd2hvQW1JID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgIHZhciB0b2tlbiwgcmVzcDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIC8vIGdldCBodHRwOi8vc3R1ZHkueXVhbmppbi50ZWNoL2FwaS91c2VyL3dob2FtaQogICAgICAgICAgICAvLyBhdXRob3JpemF0aW9uOiBiZWFyZXIgdG9rZW54eHh4eAogICAgICAgICAgICB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwoKICAgICAgICAgICAgaWYgKHRva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgIHJldHVybiBheGlvcy5nZXQoIi9hcGkvdXNlci93aG9hbWkiLCB7CiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogImJlYXJlciAiLmNvbmNhdCh0b2tlbikKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhLmRhdGEpOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTIpOwogIH0pKTsKICByZXR1cm4gX3dob0FtSS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpleHBvcnQgZnVuY3Rpb24gbG9naW5PdXQoKSB7CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oInRva2VuIik7Cn0gLy8g5rOo5YaMCgpleHBvcnQgZnVuY3Rpb24gcmVnKF94MikgewogIHJldHVybiBfcmVnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9yZWcoKSB7CiAgX3JlZyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTModXNlckluZm8pIHsKICAgIHZhciByZXNwOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gYXhpb3MucG9zdCgiL2FwaS91c2VyL3JlZyIsIHVzZXJJbmZvKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc3AuZGF0YSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMyk7CiAgfSkpOwogIHJldHVybiBfcmVnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0="},{"version":3,"sources":["/Users/smile/Documents/源码/16. 登录和注册接口/news-app/src/services/userService.js"],"names":["axios","login","loginInfo","post","resp","token","headers","authorization","localStorage","setItem","data","whoAmI","getItem","get","loginOut","removeItem","reg","userInfo"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,gBAAsBC,KAAtB;AAAA;AAAA,C,CAWA;;;mEAXO,iBAAqBC,SAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEYF,KAAK,CAACG,IAAN,CAAW,iBAAX,EAA8BD,SAA9B,CAFZ;;AAAA;AAEDE,YAAAA,IAFC;AAGDC,YAAAA,KAHC,GAGOD,IAAI,CAACE,OAAL,CAAaC,aAHpB,EAGmC;;AACxC,gBAAIF,KAAJ,EAAW;AACT;AACAG,cAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BJ,KAA9B;AACD;;AAPI,6CAQED,IAAI,CAACM,IARP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAYP,gBAAsBC,MAAtB;AAAA;AAAA,C,CAeA;;;oEAfO;AAAA;AAAA;AAAA;AAAA;AAAA;AACL;AACA;AACIN,YAAAA,KAHC,GAGOG,YAAY,CAACI,OAAb,CAAqB,OAArB,CAHP;;AAAA,gBAIAP,KAJA;AAAA;AAAA;AAAA;;AAAA,8CAKI,IALJ;;AAAA;AAAA;AAAA,mBAOYL,KAAK,CAACa,GAAN,CAAU,kBAAV,EAA8B;AAC7CP,cAAAA,OAAO,EAAE;AACPC,gBAAAA,aAAa,mBAAYF,KAAZ;AADN;AADoC,aAA9B,CAPZ;;AAAA;AAODD,YAAAA,IAPC;AAAA,8CAYEA,IAAI,CAACM,IAAL,CAAUA,IAZZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAgBP,OAAO,SAASI,QAAT,GAAoB;AACzBN,EAAAA,YAAY,CAACO,UAAb,CAAwB,OAAxB;AACD,C,CAED;;AACA,gBAAsBC,GAAtB;AAAA;AAAA;;;iEAAO,kBAAmBC,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEYjB,KAAK,CAACG,IAAN,CAAW,eAAX,EAA4Bc,QAA5B,CAFZ;;AAAA;AAEDb,YAAAA,IAFC;AAAA,8CAGEA,IAAI,CAACM,IAHP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import axios from \"axios\";\nexport async function login(loginInfo) {\n  // post http://study.yuanjin.tech/api/user/login\n  var resp = await axios.post(\"/api/user/login\", loginInfo);\n  var token = resp.headers.authorization; // 拿到服务器的令牌\n  if (token) {\n    // 把令牌保存下来\n    localStorage.setItem(\"token\", token);\n  }\n  return resp.data;\n}\n\n// 使用保存的令牌从服务器换取登录信息\nexport async function whoAmI() {\n  // get http://study.yuanjin.tech/api/user/whoami\n  // authorization: bearer tokenxxxxx\n  var token = localStorage.getItem(\"token\");\n  if (!token) {\n    return null;\n  }\n  var resp = await axios.get(\"/api/user/whoami\", {\n    headers: {\n      authorization: `bearer ${token}`,\n    },\n  });\n  return resp.data.data;\n}\n\n// 注销\nexport function loginOut() {\n  localStorage.removeItem(\"token\");\n}\n\n// 注册\nexport async function reg(userInfo) {\n  // post http://study.yuanjin.tech/api/user/reg\n  var resp = await axios.post(\"/api/user/reg\", userInfo);\n  return resp.data;\n}\n"]}]}